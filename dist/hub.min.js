var CrossStorageHub={};CrossStorageHub.init=function(e){window.localStorage&&(CrossStorageHub._originPattern=e,CrossStorageHub._installListener(),window.parent.postMessage("ready","*"))},CrossStorageHub._installListener=function(){var e=CrossStorageHub._listener;window.addEventListener?window.addEventListener("message",e,!1):window.attachEvent("onmessage",e)},CrossStorageHub._listener=function(e){var r,t,o,s,n;if(CrossStorageHub._originPattern.test(e.origin)&&(t=JSON.parse(e.data),r=["get","set","del"],CrossStorageHub._inArray(t.method,r))){try{s=CrossStorageHub["_"+t.method](t.params)}catch(a){o=a.message}n=JSON.stringify({id:t.id,error:o,result:s}),window.parent.postMessage(n,e.origin)}},CrossStorageHub._set=function(e){var r,t;if(r=e.ttl,r&&parseInt(r,10)!==r)throw new Error("ttl must be a number");t={value:e.value},r&&(t.expire=Date.now()+r),window.localStorage.setItem(e.key,JSON.stringify(t))},CrossStorageHub._get=function(e){var r,t,o,s,n;for(r=window.localStorage,t=[],o=0;o<e.keys.length;o++)n=e.keys[o],s=JSON.parse(r.getItem(n)),null===s?t.push(null):s.expire&&s.expire<Date.now()?(r.removeItem(n),t.push(null)):t.push(s.value);return t.length>1?t:t[0]},CrossStorageHub._del=function(e){for(var r=0;r<e.keys.length;r++)window.localStorage.removeItem(e.keys[r])},CrossStorageHub._inArray=function(e,r){for(var t=0;t<r.length;t++)if(e===r[t])return!0;return!1};